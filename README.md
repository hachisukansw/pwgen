pwgen - generate pronounceable passwords
====

このプログラムは "pwgen"のJavaScript版です。ウェブブラウザで使うためにJavaScriptに移植しました。バージョン2.07をベースに作られています。元のソースコードはUbuntuなら `apt source pwgen` でゲットできます。

## Demo

https://hachisukansw.github.io/pwgen/

## オプションの指定方法
オリジナルはコマンドラインなので`pwgen [オプション値]`という形式でオプションを指定できましたが、このブラウザ版ではURLの ? 以降に指定をします。URLで複数指定する場合は & でつなぎます。`/pwgen?-A&-B`という感じです。 -N や -H のように値が必要な場合は`/pwgen?-N=100`のように指定します。

## オリジナルからの変更点

### sha1.c
SHA-1のハッシュを計算するプログラムです。Cのマクロに慣れていない等々の理由でこれをJavaScriptに変換することは断念して別のSHA-1を求めるプログラムと差し替えて実現しています。差し替えたソース元はRFC 3174のドキュメント（ https://www.ietf.org/rfc/rfc3174.txt ）中に記載されていたCのプログラムです。それを選んだ理由は、ぱっと見た感じでJavaScriptに変換しやすそうに思えたのとテストプログラムもついていたからです。

### randnum.c
乱数を発生させるプログラムです。 /dev/urandom（又は/dev/random）を使用するようになっていたので、それは無理かなっとさららっと変換することは断念して、 window.crypto.getRandomValues が使える場合は使って、使えない場合は Math.random を使用するように書きなおしています。

### pwgen.c
中身はmain()関数とヘルプ文字列なので、ウェブで使うために全面的に書きなおしています。

### -Hオプション
オリジナルでは -H で指定したファイルのハッシュ値を計算するようになっていましたが同じことが難しかったので -H で指定した文字列のハッシュを計算する仕様に変更しています。ハッシュ元がまるわかりですし、ブラウザの履歴に保存されちゃう可能性もあるので使う際は注意が必要かなって思います。オリジナルでもパス名は .bash_history を見れば分かっちゃったりしましたが、それ以上に注意はいるんじゃないかなと思っています。

`-H=abc`と以下のコマンドは同じ結果となります。

```console:-H=abcと同じ結果
$ /bin/echo -n "abc" > file.txt
$ pwgen -H file.txt
```

またオリジナルではシード値を # 以降で指定できましたが#はURL中で # はうまく扱えないため : で指定できるようになっています。`-H=abc:def`と以下のコマンドは同じ結果となります。

```console:-H=abc&#58;defと同じ結果
$ /bin/echo -n "abc" > file.txt
$ pwgen -H file.txt#def
```

### -hオプション
オリジナルは英語でしたが日本語にしています。といってもgoogle翻訳で翻訳してちょこっと変更しただけのものですが、、、。以下はその内容です。

```text:-hオプション（日本語）
Usage: pwgen [ OPTIONS ] [ pw_length ] [ num_pw ]

pwgenでサポートされるオプション:
  -c or --capitalize
	パスワードに少なくとも1つの大文字を含める（デフォルト）
  -A or --no-capitalize
	パスワードに大文字を含めない
  -n or --numerals
	パスワードに少なくとも1つの数字を含める（デフォルト）
  -0 or --no-numerals
	パスワードに数字を含めない
  -y or --symbols
	少なくとも1つの特別な記号をパスワードに含める
  -s or --secure
	完全にランダムなパスワードを生成する
  -B or --ambiguous
	あいまいな文字をパスワードに含めない
  -BB or --ex-ambiguous
	あいまいな文字をパスワードに含めない（過剰版）
  -h or --help
	ヘルプメッセージを表示する
  -H or --sha1=text[:seed]
	与えられたテキストのsha1ハッシュを（そうではない）ランダムジェネレータとして使用する
  -C
	生成されたパスワードを列表示する（デフォルト）
  -1
	生成されたパスワードを列表示しない
  -v or --no-vowels
	母音を使用しない

フィルター:
   --uniq
	同じパスワードを含めない
   --grep-upper
	大文字を含むものに限定する
   --grep-lower
	小文字を含むものに限定する
   --grep-digit
	数字を含むものに限定する
   --grep-punct
	特殊文字を含むものに限定する
   --uniq-char
	パスワード中に同じ文字を含めない
   --same2char
	パスワード中に同じ文字を2つ以上含める
   --same3char
	パスワード中に同じ文字を3つ以上含める
   --reading
	パスワードの読みを追加する
```

### -BBオプション
-B（あいまいな文字除外）の過剰版です。

```text:pw_rand.c
（オリジナル版 -Bオプション）
const pw_ambiguous = "B8G6I1l0OQDS5Z2";

（過剰版 -BBオプション）
const pw_ambiguous = "B8G6bI1l7i0OoQDSs5Zz29qgadCcKkUuVvXx";
```

### フィルター
オプションで -c を指定しても大文字が含まれないことが稀にあって、困ることもありそうなので、結果から大文字を含むものだけに限定する`grep[A-Z]`等のフィルターを追加してみました。
